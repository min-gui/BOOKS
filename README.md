# sql-tuning

## 업무에 바로 쓰는 SQL 튜닝

<img width="200" alt="image" src="https://contents.kyobobook.co.kr/sih/fit-in/458x0/pdt/9791162244500.jpg">

## 정리
## 목차

* [1. MySQL과 MariaDB개요](#1-mysql과-mariadb개요)
  * [구조적 차이](#구조적-차이)
* [2. SQL 튜닝용어를 직관적으로 이해하기](#2-sql-튜닝용어를-직관적으로-이해하기)
  * [물리 엔진과 오브젝트 용어](#물리-엔진과-오브젝트-용어)
  
  
## 1. MySQL과 MariaDB개요


버전 찾기
```sql
SHOW VARIABLES LIKE 'version%';
SELECT @@version;
```


### 구조적 차이
- Oracle
  - 통합된 스토리지 하나를 공유.
  - 사용자가 어느 DB 서버에 접속 하여 작업 하더라도 같은 결과 출력, 동일한 구문 CRUD
  를 처리할 수 있다.
- MySQL
  - 물리적인 DB 서버 마다 독립적으로 스토리지를 할당.
  - 마스터 - 슬레이브 (주-종 구조) 가 대부분. 마스터는 쓰기/읽기 가능, 슬레이브는 읽기만 
  가능. 여러대 DB 서버에 접속해서 CRUD를 실행하더라도 처리되지 않을 수 있다.
  - 상대적인 낮은 메모리 사용.
  - 중첩 루프 조인 알고리즘만으로 풀림.

  
  *_쿼리 오프로딩_  
  트랜잭션 쓰기(UPDATE, INSERT, DELETE) ,읽기(SELECT) 분리하여 처리량 증가 기법
  
  
## 2.SQL 튜닝용어를 직관적으로 이해하기
### 물리 엔진과 오브젝트 용어

- MySQL 엔진
  - Parsor : SQL 문법 검사, SQL 문을 최소 단위로 분리하고 트리 생성.
  - Preprocessor : SQL 문 구조적인 문제 없는지 파악. 테이블, 열, 함수, 뷰와 같은
  오브젝트가 실질적으로 생성된 오브젝트인지 확인. 접근 권한 여부 확인.
  - Optimizer : 핵심 엔진 중 하나. 테이블에 접근 순서계획 설정, 인덱스 사용 여부 및 인덱스 종류 선택 할지와 같은
  실행 계획을 수립.
  - Executor : Optimizer의 실행 계획을 참고하여 스토리지 엔진에서 데이터 가져온다.
  읽어온 데이터를 정렬,조인,필터링 처리한다. 부하를 줄이려면 스토리지에서 가져오는 데이터양을 줄이는게
    중요하다.
- 스토리지 엔진
  - InnoDB : OLTP 지원, 대다수 사용.
  - MyISAM : 풀 텍스트 인덱스, 대량의 쓰기 트랜잭션 발생하면 사용.
  - Memory : 메모리 데이터를 로드하여 빠르게 읽는 효과.

- 실행순서
  - SQL 실행 -> 파서 -> 전처리기-> 옵티마이저 -> 스토리지 엔진 -> 결과 수신
<br><br>
- 인덱스
  - 실제 데이터 위치를 식별하고 데이터 접근 속도를 높이기 위해 키 기준으로 정렬된 오브젝트
- 고유 인덱스(unique index)
- 중복된 값을 허용하지 않는 인덱스, 불필요한 중복 검증 과정이 추가되니 주의.
<br><br>
*___인덱스 주의사항___  
기본키와 똑같은 인덱스를 생성하면 물리적 공간이 낭비되고, 데이터 삽입/삭제/수정에 대한 오버헤드가 발생.  
기본키에는 NULL을 입력할 수 없지만, 고유 인덱스는 입력 가능.
<br><br>
- 뷰
  - 가상테이블, 유령과 같은 오브젝트. 조인 및 개인정보를 외부에 직접적으로 공개하지 않도록 
  제한된 정보만 제공 가능하다. 안전하게 운영 개발 가능해 보안성 향상.





